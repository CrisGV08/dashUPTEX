{# api/templates/tasa_de_titulacion_usuario.html #}
{% extends 'base.html' %}
{% load static %}
{% block title %}Tasa de Titulaci칩n{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/tasa_titulacion.css' %}?v=20250909">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />

<h2 class="titulo-principal">游늳 Tasa de Titulaci칩n <span id="promedioGlobal" class="badge"></span></h2>

<!-- Filtros (solo lectura) -->
<div class="filtros">
  <div class="filtro">
    <label for="filtro_anio"><strong>A침os de ingreso</strong></label>
    <select id="filtro_anio" multiple>
      {% for anio in anios %}
        <option value="{{ anio }}" selected>{{ anio }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="filtro">
    <label for="filtro_programa"><strong>Programas</strong></label>
    <select id="filtro_programa" multiple>
      {% for p in programas_antiguos %}<option value="{{ p.nombre }}" selected>{{ p.nombre }}</option>{% endfor %}
      {% for p in programas_nuevos %}<option value="{{ p.nombre }}" selected>{{ p.nombre }}</option>{% endfor %}
    </select>
  </div>

  <div class="filtro">
    <label for="filtro_tipo"><strong>Tipo de programa</strong></label>
    <select id="filtro_tipo" multiple>
      <option value="ANTIGUO" selected>ANTIGUO</option>
      <option value="NUEVO" selected>NUEVO</option>
    </select>
  </div>

  <div class="filtro">
    <label for="filtro_vista"><strong>Mostrar</strong></label>
    <select id="filtro_vista" multiple>
      <option value="linea" selected>Gr치fica de l칤nea</option>
      <option value="tabla" selected>Tabla por programa</option>
      <option value="barras" selected>Gr치fica de barras</option>
    </select>
  </div>

  <div class="acciones-filtros">
    <button id="aplicarFiltros" class="btn-guardar" type="button">Aplicar filtros</button>
    <button id="resetFiltros" class="btn-guardar btn-secundario" type="button">Restablecer</button>
    <button id="btnDescargarPDF" class="btn-guardar" type="button">游늯 Descargar PDF</button>
  </div>
</div>

<!-- Contenido exportable (el men칰 de base.html permanece intacto) -->
<div id="seccionDescargable">
  <div id="avisos" class="mensajes" style="display:none"></div>
  <div id="cardsProgramas" class="cards-programas"></div>
</div>

<!-- Datos para JS -->
<script type="application/json" id="jsonDatos">{{ datos_json|safe }}</script>

<!-- Librer칤as -->
<script defer src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
<script defer src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<!-- JS de esta vista -->
<script defer src="{% static 'js/tasa_de_titulacion_usuario.js' %}?v=20250909"></script>
{% endblock %}
